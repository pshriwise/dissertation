
\chapter{Modified DAGMC Simulation Results}\label{ch:appendix-b}

This appendix contains all results for simulations performed using modified
versions of DAGMC. Because a numerical comparison, as opposed to a statistical
comparison, is being made between these different implementations, error values
are not included in the tables of this appendix. The results of native MCNP
simulations have been provided when possible for reference. MCNP results are
expected to be statistically similar but not the same as DAG-MCNP results. All
implementations of DAG-MCNP (EmDAG, SDF, unmodified DAGMC, etc.) are expected to
report the same numerical tally results. Additional CDF plots for differing mesh
tally results are included when necessary.

\section{EmDAG-MCNP}

The results in this section were generated using the EmDAG
implementaion presented in Section \ref{sec:embree}. These include several
contrived test cases in Section \ref{appsec:emdag_simple_tests} along with a
production model test of FNG with the EmDAG system in Section \ref{appsec:emdag_fng}.

\subsection{Simple Test Cases}\label{appsec:emdag_simple_tests}
  \subsubsection{Single Cube}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & DAG-MCNP with MPBVH \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \hline
        Flux   & 5.61567E-03 & 5.61567E-03 & 5.61567E-03 \\
        Energy & 2.98787E-03 & 2.98787E-03 & 2.98787E-03 \\
        \bottomrule
      \end{tabular}
      \caption[Single hydrogen-filled cube tally results.]{Single
        hydrogen-filled cube tally results. Flux tally units are
        $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}


  \subsubsection{Nested Cubes}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & EmDAG-MCNP \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \multicolumn{4}{l}{\textbf{Cell 1 Tallies}} \\
        \hline
        Flux    &  1.38556E-02 & 1.38556E-02 & 1.38556E-02 \\
        Energy  &  1.05974E-02 & 1.05974E-02 & 1.05974E-02 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 2 Tallies}} \\
        \hline
        Flux    & 1.41609E-03 & 1.41609E-03 & 1.91644E-04 \\
        Energy  & 4.81169E-04 & 4.81169E-04 & 4.81169E-04 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 3 Tallies}} \\
        \hline
        Flux    & 1.92847E-04 &  1.92847E-04 & 1.92847E-04 \\
        Energy  & 1.10361E-04 &  1.10361E-04 & 1.10361E-04 \\
        \bottomrule
        
      \end{tabular}
      \caption[Nested hydrogen-filled cube tally results.]{Nested
        hydrogen-filled cube tally results. Flux tally units are
        $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}


  \subsubsection{Single Sphere}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & DAG-MCNP with MPBVH \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \hline
        Flux   & 4.98069E-03 & 4.98639E-03 & 4.98639E-03 \\
        Energy & 3.17629E-03 & 3.18079E-03 & 3.18079E-03 \\
        \bottomrule
      \end{tabular}
      \caption[Single hydrogen-filled sphere tally results.]{Single
        hydrogen-filled sphere tally results. Flux tally units are
        $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}

  \subsubsection{Nested Spheres}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & EmDAG-MCNP \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \multicolumn{4}{l}{\textbf{Cell 1 Tallies}} \\
        \hline
        Flux    & 5.25725E-03 & 5.25734E-03 & 5.25734E-03 \\
        Energy  & 3.17869E-03 &  3.17873E-03 &  3.17873E-03 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 2 Tallies}} \\
        \hline
        Flux    & 1.91645E-04 & 1.91644E-04 & 1.91644E-04 \\
        Energy  & 5.22131E-05 & 5.22137E-05 & 5.22137E-05 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 3 Tallies}} \\
        \hline
        Flux    & 1.18371E-05 & 1.18\textbf{376}E-05 & 1.18\textbf{410}E-05 \\
        Energy  & 4.96282E-06 & 4.96285E-06 & 4.96285E-06 \\
        \bottomrule
        
      \end{tabular}
      \caption[Nested Spheres Tally Results.]{Nested Spheres Tally Results. Flux
        tally units are $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}

  \section{Production Test Cases}\label{appsec:emdag_fng}
  
  \subsubsection{FNG}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & EmDAG-MCNP \\
        \hline
        \multicolumn{4}{l}{\textbf{Neutron Flux}} \\
        \hline
        Average & 7.228758E-05 & 7.3211\textbf{88}E-05 & 7.3211\textbf{69}E-05 \\
        Maximum & 1.457240E-04 & 1.4858\textbf{8}0E-04 & 1.4858\textbf{4}0E-04 \\
        Minimum & 1.997170E-05 & 1.9384\textbf{4}0E-05 & 1.9384\textbf{5}0E-05 \\
        \bottomrule
      \end{tabular}
    \end{center}
    \caption[Flux tally results in FNG for various DAG-MCNP
      implementations.]{Summary of the flux tally results for a global
      volumetric source in the FNG model for MCNP, DAG-MCNP, and Embree coupled
      with DAGMC, or EmDAG-MCNP. Units of flux are in $cm^{-2}$.}
  \end{table}

  \begin{figure}[H]
    \centering
    \includesvg{../images/emdag_fng_meshtally_cdf}{width=\textwidth}
    \caption[Analysis of differing mesh tallies in FNG.]{A cumulative
      distribution function for the differing tally values between DAG-MCNP and
      EmDAG-MCNP for the FNG model. Zero entries for the unmodified DAG-MCNP
      simulation are set to zero here. }
  \end{figure}
  
  \section{MPBVH}

  The results in this section were generated using DAG-MCNP relying on the MPBVH
  as its ray tracing kernel as presented in Section \ref{sec:MPBVH}. These
  include several contrived test cases in Section
  \ref{appsec:mpbvh_simple_tests} along with several production model
  demonstrations in Section \ref{appsec:mpbvh_production_tests}.

\subsection{Simple Test Cases}\label{appsec:mpbvh_simple_tests}

  \subsubsection{Single Cube}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & DAG-MCNP with MPBVH \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \hline
        Flux   & 5.61567E-03 & 5.61567E-03 & 5.61567E-03 \\
        Energy & 2.98787E-03 & 2.98787E-03 & 2.98787E-03 \\
        \bottomrule
      \end{tabular}
      \caption[Single hydrogen-filled cube tally results.]{Single
        hydrogen-filled cube tally results. Flux tally units are
        $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}


  \subsubsection{Nested Cubes}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & EmDAG-MCNP \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \multicolumn{4}{l}{\textbf{Cell 1 Tallies}} \\
        \hline
        Flux    &  1.38556E-02 & 1.38556E-02 & 1.38556E-02 \\
        Energy  &  1.05974E-02 & 1.05974E-02 & 1.05974E-02 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 2 Tallies}} \\
        \hline
        Flux    & 1.41609E-03 & 1.41609E-03 & 1.91644E-04 \\
        Energy  & 4.81169E-04 & 4.81169E-04 & 4.81169E-04 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 3 Tallies}} \\
        \hline
        Flux    & 1.92847E-04 &  1.92847E-04 & 1.92847E-04 \\
        Energy  & 1.10361E-04 &  1.10361E-04 & 1.10361E-04 \\
        \bottomrule
        
      \end{tabular}
      \caption[Nested hydrogen-filled cube tally results.]{Nested
        hydrogen-filled cube tally results. Flux tally units are
        $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}


  \subsubsection{Single Sphere}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & DAG-MCNP with MPBVH \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \hline
        Flux   & 4.98069E-03 & 4.98639E-03 & 4.98639E-03 \\
        Energy & 3.17629E-03 & 3.18079E-03 & 3.18079E-03 \\
        \bottomrule
      \end{tabular}
      \caption[Single hydrogen-filled sphere tally results.]{Single
        hydrogen-filled sphere tally results. Flux tally units are
        $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}

  \subsubsection{Nested Spheres}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & DAG-MCNP with MPBVH \\
        \toprule
        %%Hist/min & 2.2991E+05 & 1.9877E+04 & 1.3947E+05 \\
        %%\hline
        \multicolumn{4}{l}{\textbf{Cell 1 Tallies}} \\
        \hline
        Flux   & 5.25725E-03 & 5.25734E-03 & 5.25734E-03 \\
        Energy & 3.17869E-03 & 3.17873E-03 & 3.17873E-03 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 2 Tallies}}      \\
        \hline
        Flux   & 1.91645E-04 & 1.91644E-04 & 1.91644E-04 \\
        Energy & 5.22131E-05 & 5.22137E-05 & 5.22137E-05 \\
        \hline
        \multicolumn{4}{l}{\textbf{Cell 3 Tallies}}      \\
        \hline
        Flux   & 1.18371E-05 & 1.18376E-05 & 1.18376E-05 \\
        Energy & 4.96282E-06 & 4.96285E-06 & 4.96285E-06 \\
        \bottomrule
      \end{tabular}
      \caption[Nested Spheres Tally Results.]{Nested Spheres Tally Results. Flux
        tally units are $cm^{-2}$. Energy tally units are MeV/g.}
      \label{nestedspheres}
    \end{center}
    %%\vspace{-0.2cm}
  \end{table}

\subsection{Production Tests}\label{appsec:mpbvh_production_tests}

\subsubsection{FNG}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & DAG-MCNP-MPBVH \\
        \hline
        Average & 7.227982E-05 & 7.230336E-05 & 7.230336E-05 \\
        Maximum & 1.471770E-04 & 1.471210E-04 & 1.471210E-04 \\
        Minimum & 1.918080E-05 & 1.877310E-05 & 1.877310E-05 \\
        \bottomrule
      \end{tabular}
    \end{center}
    \caption[Flux tally results in FNG for various DAG-MCNP
      implementations.]{Summary of the flux tally results for a global
      volumetric source in the FNG model for MCNP, DAG-MCNP, and DAG-MCNP using
      the MPBVH.}
  \end{table}

  \subsubsection{ATR}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value & MCNP & DAG-MCNP & DAG-MCNP-MPBVH \\
        \toprule
        $k_{coll}$  & 0.99218 & 0.98456 & 0.98456  \\
        $k_{abs}$   & 0.98764 & 0.99448 & 0.99448  \\
        $k_{track}$ & 0.98899 & 0.98283 & 0.98283  \\
        \bottomrule
      \end{tabular}
    \end{center}
    \caption[Results of eigenvalue simulations in ATR for various DAG-MCNP
      implementations.]{Results of an eigenvalue simulation for the Advanced
      Test Reactor at Idaho National Laboratory over 100 cycles.}
  \end{table}

  \subsubsection{UWNR}

  
  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lccc}
        \toprule
        Value     & MCNP    & DAG-MCNP & DAG-MCNP-MPBVH \\
        \toprule
        $k_{coll}$  & 1.02050 & 1.02084  & 1.02084        \\
        $k_{abs}$   & 1.02044 & 1.02072  & 1.02072        \\
        $k_{track}$ & 1.02041 & 1.02063  & 1.02063        \\
        \bottomrule
      \end{tabular}
    \end{center}
    \caption[Results of eigenvalue simulations in UWNR for various DAG-MCNP
      implementations.]{Results of an eigenvalue simulation for the University
      of Wisconsin Nuclear Reactor over 75 cycles.}
  \end{table}


  \subsubsection{ITER}

  \begin{table}[H]
    \small
    \begin{center}
      \begin{tabular}{lcc}
        \toprule
        Value   & DAG-MCNP     & DAG-MCNP with MPBVH      \\
        \toprule
        \multicolumn{3}{l}{\textbf{Neutron Flux}} \\
        Average & 7.222176E+12 & 7.217213E+12   \\
        Maximum & 1.410510E+14 & 1.410040E+14   \\
        Minimum & 0.000000E+00 & 0.000000E+00   \\       
        \bottomrule
      \end{tabular}
    \end{center}
    \caption[Flux tally results in the ITER model for various DAG-MCNP
      implementations.]{Result comparison for a mesh-based flux tally applied to
      the ITER neutronics model for \num{1E6} histories. Units are in $cm^{-2}$}
  \end{table}
  
  \begin{figure}[H]
    \centering
    \includesvg{../images/iter_mpbvh_meshtally_cdf}{width=\textwidth}
    \caption[Analysis of differing mesh tallies in ITER.]{A cumulative
      distribution function for the differing tally values between DAG-MCNP and
      DAG-MCNP using the MPBVH for the ITER model. Zero entries for the
      unmodified DAG-MCNP simulation are set to zero here. }
  \end{figure}

  \begin{table}[H]
    \begin{center}
      \begin{tabular}{cc}
        Number of Tally Values & Standard Deviation \\
        0.50 & 59.69 \\
        0.75 & 108.77 \\
        0.90 & 162.93 \\
        0.95 & 213.71 \\
        0.99 & 353.51 \\
      \end{tabular}
    \end{center}
  \end{table}
  
  \section{Signed Distance Field}

  The results in this section are the result of signed distance field
  application in DAGMC production models, seen in Section
  \ref{sec:sdf_production}. 
  
\subsection{Production Tests}

\subsubsection{ITER}

\begin{table}[H]
  \small
  \begin{center}
    \begin{tabular}{lcc}
          \toprule
          Value   & DAG-MCNP     & DAG-MCNP with SDF      \\
          \toprule
          \multicolumn{3}{l}{\textbf{Neutron Flux Tally}} \\
          Average & 2.123795E-09 & 2.123795E-09           \\
          Maximum & 3.170170E-06 & 3.170170E-06           \\
          Minimum & 0.000000E+00 & 0.000000E+00           \\
          \bottomrule
    \end{tabular}
  \end{center}
  \caption[Flux tally results in the ITER model for various DAG-MCNP
    implementations.]{Result comparison for a mesh-based flux tally applied to
    the ITER neutronics model for \num{1E7} histories. Units are in $cm^{-2}$.}
\end{table}


\subsubsection{nTOF}

\begin{table}[H]
  \small
  \begin{center}
    \begin{tabular}{lcc}
          \toprule
          Value   & DAG-MCNP     & DAG-MCNP with SDF      \\
          \toprule
          \multicolumn{3}{l}{\textbf{Neutron Flux Tally}} \\
          Average & 7.730000E+00 & 7.730000E+00           \\
          Maximum & 3.250500E+01 & 3.250500E+01           \\
          Minimum & 1.704500E+01 & 1.704500E+01           \\
          \multicolumn{3}{l}{\textbf{Proton Flux Tally}}  \\
          Average & 1.539597E-04 & 1.539597E-04           \\
          Maximum & 1.045990E+00 & 1.045990E+00           \\
          Minimum & 0.000000E+00 & 0.000000E+00           \\
          \multicolumn{3}{l}{\textbf{Photon Flux Tally}}  \\
          Average & 3.255857E-03 & 3.255857E-03           \\
          Maximum & 5.343100E-01 & 5.343100E-01           \\
          Minimum & 0.000000E+00 & 0.000000E+00           \\
          \bottomrule
    \end{tabular}
  \end{center}
  \caption[Results of flux mesh tallies for several particle types in the nTOF
    model.]{A result comparison between DAG-MCNP with and without the SDF field
    applied for 10K histories in the the neutron Time-Of-Flight model. Units are
    in $cm^{-2}$.}
\end{table}

\subsubsection{SHINE}

\begin{table}[H]
  \small
  \begin{center}
    \begin{tabular}{lcc}
          \toprule
          Value   & DAG-MCNP     & DAG-MCNP with SDF      \\
          \toprule
          \multicolumn{3}{l}{\textbf{Neutron Flux Tally}} \\
          Average & 2.486558E+10 & 2.486558E+10           \\
          Maximum & 2.330400E+12 & 2.330400E+12           \\
          Minimum & 0.000000E+00 & 0.000000E+00           \\
          \bottomrule
    \end{tabular}
  \end{center}
  \caption[Flux tally results in the SHINE model for various DAG-MCNP
    implementations.]{A result comparison for the SHINE model with and without
    SDF application for 10k particle histories. Units are in $cm^{-2}$.}
\end{table}

\subsubsection{SNS}

\begin{table}[H]
  \small
  \begin{center}
    \begin{tabular}{lcc}
      \toprule
      Tally Number & DAG-MCNP   & DAG-MCNP with SDF \\
      \toprule
      6            & 1.5927E-01 & 1.5927E-01        \\
      24           & 1.8279E-01 & 1.8279E-01        \\
      46           & 1.1338E+00 & 1.1338E+00        \\
      76           & 4.3240E-01 & 4.3240E-01        \\
      106          & 6.7470E-02 & 6.7470E-02        \\
      126          & 1.4468E+00 & 1.4468E+00        \\
      146          & 6.5084E-02 & 6.5084E-02        \\
      166          & 1.6627E+00 & 1.6627E+00        \\
      206          & 1.1284E+01 & 1.1284E+01        \\
      114          & 4.0555E+00 & 4.0555E+00        \\
      174          & 4.0451E+00 & 4.0451E+00        \\
      14           & 3.7261E-02 & 3.7261E-02        \\
      26           & 4.2035E-01 & 4.2035E-01        \\
      56           & 1.7891E-01 & 1.7891E-01        \\
      86           & 1.7698E-01 & 1.7698E-01        \\
      116          & 2.6279E-01 & 2.6279E-01        \\
      136          & 9.6872E-02 & 9.6872E-02        \\
      156          & 2.5599E-01 & 2.5599E-01        \\
      176          & 1.0053E-01 & 1.0053E-01        \\
      216          & 8.3326E+00 & 8.3326E+00        \\
      134          & 1.9720E+00 & 1.9720E+00        \\
      214          & 6.0137E+02 & 6.0137E+02        \\
      16           & 1.0738E-01 & 1.0738E-01        \\
      36           & 4.1034E-01 & 4.1034E-01        \\
      66           & 5.4782E-01 & 5.4782E-01        \\
      104          & 2.9490E+03 & 2.9490E+03        \\
      124          & 8.8337E+02 & 8.8337E+02        \\
      144          & 6.8868E+02 & 6.8868E+02        \\
      164          & 7.3002E+02 & 7.3002E+02        \\
      204          & 7.9032E+01 & 7.9032E+01        \\
      226          & 3.1626E-01 & 3.1626E-01        \\
      154          & 3.4720E+00 & 3.4720E+00        \\
      \bottomrule
    \end{tabular}
    \caption[Results of tally values in SNS for various DAG-MNP
      implementations.]{Result comparison for a variety of atom displacement
      tallies in the Spallation Neutron Source model in DAG-MCNP both with and
      without the SDF for 10K histories.}
  \end{center}
\end{table}
